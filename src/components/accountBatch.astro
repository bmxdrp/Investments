---
import AccountBatchCard from "./accountBatch.astro";
interface Props {
  account: any;
  level?: number;
}

const { account, level = 0 } = Astro.props;
const indent = level * 16;
---

<div
  class="account-card p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-gray-300 transition"
  data-account-id={account.id}
  style={`margin-left:${indent}px`}
>
  <div class="flex items-start gap-3 mb-3">
    <input
      type="checkbox"
      class="account-checkbox mt-1 w-5 h-5 text-blue-600 rounded"
      data-account-id={account.id}
    />

    <div class="flex-1">
      <h3 class="font-semibold text-gray-800">
        {account.name}
      </h3>
      <p class="text-xs text-gray-500">
        {account.type} · {account.currency}
      </p>
      <p class="text-xs text-gray-400 mt-1">
        Última actualización:
        {new Date(account.last_update).toLocaleDateString("es-CO")}
      </p>
    </div>
  </div>

  <div class="ml-8">
    <label class="block text-xs font-medium text-gray-600 mb-1">
      Valor Actual: {Number(account.current_value).toFixed(2)} {account.currency}
    </label>

    <input
      type="number"
      step="0.01"
      class="account-value w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"
      data-account-id={account.id}
      data-currency={account.currency}
      data-previous-value={account.current_value}
      value={Number(account.current_value).toFixed(2)}
      disabled
    />
  </div>
</div>

{account.children.length > 0 && (
  <div class="space-y-2">
    {account.children.map((child) => (
      <AccountBatchCard account={child} level={level + 1} />
    ))}
  </div>
)}
